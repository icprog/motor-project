###############################################################################
#                                                                             #
# IAR ANSI C/C++ Compiler V6.60.2.5449/W32 for ARM      10/Mar/2015  10:52:20 #
# Copyright 1999-2013 IAR Systems AB.                                         #
#                                                                             #
#    Cpu mode     =  thumb                                                    #
#    Endian       =  little                                                   #
#    Source file  =  C:\Users\Quinn\Documents\GitHub\motor-project\src\driver #
#                    s\solenoid.c                                             #
#    Command line =  C:\Users\Quinn\Documents\GitHub\motor-project\src\driver #
#                    s\solenoid.c -D __SAM3U2C__ --preprocess=c               #
#                    C:\Users\Quinn\Documents\GitHub\motor-project\project\De #
#                    bug\List\ -lcN C:\Users\Quinn\Documents\GitHub\motor-pro #
#                    ject\project\Debug\List\ --diag_suppress Pa050 -o        #
#                    C:\Users\Quinn\Documents\GitHub\motor-project\project\De #
#                    bug\Obj\ --no_cse --no_unroll --no_inline                #
#                    --no_code_motion --no_tbaa --no_clustering               #
#                    --no_scheduling --debug --endian=little --cpu=Cortex-M3  #
#                    -e --fpu=None --dlib_config "C:\Program Files (x86)\IAR  #
#                    Systems\Embedded Workbench 6.5\arm\INC\c\DLib_Config_Nor #
#                    mal.h" -I C:\Users\Quinn\Documents\GitHub\motor-project\ #
#                    project\..\src\ -I C:\Users\Quinn\Documents\GitHub\motor #
#                    -project\project\..\src\bsp\ -I                          #
#                    C:\Users\Quinn\Documents\GitHub\motor-project\project\.. #
#                    \src\app\ -I C:\Users\Quinn\Documents\GitHub\motor-proje #
#                    ct\project\..\src\lib\utils\ -I                          #
#                    C:\Users\Quinn\Documents\GitHub\motor-project\project\.. #
#                    \src\lib\structures\src\ -I                              #
#                    C:\Users\Quinn\Documents\GitHub\motor-project\project\.. #
#                    \src\lib\file\ -I C:\Users\Quinn\Documents\GitHub\motor- #
#                    project\project\..\src\lib\file\hooks\FatFs\ -I          #
#                    C:\Users\Quinn\Documents\GitHub\motor-project\project\.. #
#                    \src\lib\file\disk\ -I C:\Users\Quinn\Documents\GitHub\m #
#                    otor-project\project\..\src\lib\version\ -I              #
#                    C:\Users\Quinn\Documents\GitHub\motor-project\project\.. #
#                    \src\lib\FatFs\ -I C:\Users\Quinn\Documents\GitHub\motor #
#                    -project\project\..\src\bsp\ -I                          #
#                    C:\Users\Quinn\Documents\GitHub\motor-project\project\.. #
#                    \src\config\ -I C:\Users\Quinn\Documents\GitHub\motor-pr #
#                    oject\project\..\src\drivers\ -I                         #
#                    C:\Users\Quinn\Documents\GitHub\motor-project\project\.. #
#                    \src\utils\ -I C:\Users\Quinn\Documents\GitHub\motor-pro #
#                    ject\project\..\src\drivers\ -On -I "C:\Program Files    #
#                    (x86)\IAR Systems\Embedded Workbench                     #
#                    6.5\arm\CMSIS\Include\"                                  #
#    List file    =  C:\Users\Quinn\Documents\GitHub\motor-project\project\De #
#                    bug\List\solenoid.lst                                    #
#    Object file  =  C:\Users\Quinn\Documents\GitHub\motor-project\project\De #
#                    bug\Obj\solenoid.o                                       #
#                                                                             #
#                                                                             #
###############################################################################

C:\Users\Quinn\Documents\GitHub\motor-project\src\drivers\solenoid.c
      1          /*******************************************************************************************
      2          Description:
      3          Controls the timing of the solenoids based on a given period and voltage
      4          
      5          Quinn Miller
      6          ********************************************************************************************/
      7          
      8          
      9          #include "solenoid.h"
     10          #include "tact.h"
     11          
     12          /* Testing123 */
     13          #include "led.h"
     14          /* Testing123 */
     15          
     16          /**************************************************************************
     17           *                                  Constants
     18           **************************************************************************/
     19          int DEFAULT_VOLTS = 0;
     20          int DEFAULT_PERIOD = 1000;
     21          
     22          int BUFFER_PERCENT = 10;
     23          /**************************************************************************
     24           *                                  Types
     25           **************************************************************************/
     26          /**************************************************************************
     27           *                                  Variables
     28           **************************************************************************/
     29          int sol1Start;
     30          int sol1Stop;
     31          int sol2Start;
     32          int sol2Stop;
     33          int periodSol;
     34          int voltage;
     35          
     36          int tSinceTick;
     37          /**************************************************************************
     38           *                                  Prototypes
     39           **************************************************************************/
     40          
     41          /**************************************************************************
     42           *                                  Global Functions
     43           **************************************************************************/
     44          void SolenoidInit() {
     45               SetSolenoidParam(DEFAULT_VOLTS, DEFAULT_PERIOD);
     46          }
     47          
     48          void SolenoidUpdate() {
     49            
     50            // update solenoid outputs
     51            tSinceTick = GetTimeSinceTick();
     52            
     53            if ( sol1Start<tSinceTick && tSinceTick<sol1Stop ) {
     54              LedOn(LED_GREEN);
     55              LedOff(LED_ORANGE);
     56            } else if ( sol2Start<tSinceTick && tSinceTick<sol2Stop ) {
     57              LedOn(LED_ORANGE);
     58              LedOff(LED_GREEN);
     59            } else {
     60              LedOff(LED_GREEN);
     61              LedOn(LED_ORANGE);
     62            }
     63          }
     64          
     65          void SetSolenoidParam(int volts, int periodMs) {
     66            periodSol = periodMs;
     67            voltage = volts;
     68            
     69              // initialize variables
     70            sol1Start = (int)(periodSol*BUFFER_PERCENT/100);
     71            sol1Stop = (int)(periodSol*(0.5-BUFFER_PERCENT/100));
     72            sol2Start = (int)(periodSol*(0.5+BUFFER_PERCENT/100));
     73            sol2Stop = (int)(periodSol*(1-BUFFER_PERCENT/100));
     74          }
     75          /**************************************************************************
     76           *                                 Private Functions
     77           **************************************************************************/
     78          

   Maximum stack usage in bytes:

   .cstack Function
   ------- --------
      24   SetSolenoidParam
        24   -> __aeabi_d2iz
        24   -> __aeabi_dadd
        24   -> __aeabi_dmul
        24   -> __aeabi_dsub
        24   -> __aeabi_i2d
       8   SolenoidInit
         8   -> SetSolenoidParam
       8   SolenoidUpdate
         8   -> GetTimeSinceTick
         8   -> LedOff
         8   -> LedOn


   Section sizes:

   Bytes  Function/Label
   -----  --------------
       4  ??DataTable2
       4  ??DataTable2_1
       4  ??DataTable2_10
       4  ??DataTable2_2
       4  ??DataTable2_3
       4  ??DataTable2_4
       4  ??DataTable2_5
       4  ??DataTable2_6
       4  ??DataTable2_7
       4  ??DataTable2_8
       4  ??DataTable2_9
       4  BUFFER_PERCENT
       4  DEFAULT_PERIOD
       4  DEFAULT_VOLTS
     164  SetSolenoidParam
      16  SolenoidInit
     100  SolenoidUpdate
       4  periodSol
       4  sol1Start
       4  sol1Stop
       4  sol2Start
       4  sol2Stop
       4  tSinceTick
       4  voltage

 
  32 bytes in section .bss
   8 bytes in section .data
 324 bytes in section .text
 
 324 bytes of CODE memory
  40 bytes of DATA memory

Errors: none
Warnings: none
